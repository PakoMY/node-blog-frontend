{"remainingRequest":"/Users/pako/work/workspace/node-blog/blog/node_modules/thread-loader/dist/cjs.js!/Users/pako/work/workspace/node-blog/blog/node_modules/babel-loader/lib/index.js!/Users/pako/work/workspace/node-blog/blog/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/pako/work/workspace/node-blog/blog/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/pako/work/workspace/node-blog/blog/src/views/Personal.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/pako/work/workspace/node-blog/blog/src/views/Personal.vue","mtime":1613318065682},{"path":"/Users/pako/work/workspace/node-blog/blog/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/pako/work/workspace/node-blog/blog/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/pako/work/workspace/node-blog/blog/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/pako/work/workspace/node-blog/blog/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/pako/work/workspace/node-blog/blog/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IGltZ0RlZmF1bHQgZnJvbSAnLi4vYXNzZXRzL2xvZ28ucG5nJzsKaW1wb3J0IENvb2tpZSBmcm9tICdqcy1jb29raWUnOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZvcm06IHsKICAgICAgICBuaWNrbmFtZTogdGhpcy5uaWNrbmFtZQogICAgICB9LAogICAgICBpbWFnZVVybDogbnVsbCwKICAgICAgaW1nRGVmYXVsdDogaW1nRGVmYXVsdAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHNhdmU6IGZ1bmN0aW9uIHNhdmUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB0aGlzLiRheGlvcy5wb3N0KCcvYXBpL3VzZXIvdXBkYXRlVXNlcicsIHsKICAgICAgICBuaWNrbmFtZTogdGhpcy5mb3JtLm5pY2tuYW1lLAogICAgICAgIGhlYWRfaW1nOiB0aGlzLmltYWdlVXJsCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CgogICAgICAgIGlmIChyZXMuZGF0YS5jb2RlID09PSAwKSB7CiAgICAgICAgICBfdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgIG1lc3NhZ2U6ICfmm7TmlrDmiJDlip8nLAogICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgICAgIH0pOwoKICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgICAgIH0sIDE1MDApOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgfSk7CiAgICB9LAogICAgaGFuZGxlQXZhdGFyU3VjY2VzczogZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VjY2VzcyhyZXMpIHsKICAgICAgdGhpcy5pbWFnZVVybCA9IHJlcy5kYXRhOwogICAgfSwKICAgIGJlZm9yZUF2YXRhclVwbG9hZDogZnVuY3Rpb24gYmVmb3JlQXZhdGFyVXBsb2FkKGZpbGUpIHsKICAgICAgdmFyIGlzSlBHID0gZmlsZS50eXBlID09PSAnaW1hZ2UvanBlZyc7CiAgICAgIHZhciBpc0x0Mk0gPSBmaWxlLnNpemUgLyAxMDI0IC8gMTAyNCA8IDI7CgogICAgICBpZiAoIWlzSlBHKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5LiK5Lyg5aS05YOP5Zu+54mH5Y+q6IO95pivIEpQRyDmoLzlvI8hJyk7CiAgICAgIH0KCiAgICAgIGlmICghaXNMdDJNKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5LiK5Lyg5aS05YOP5Zu+54mH5aSn5bCP5LiN6IO96LaF6L+HIDJNQiEnKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGlzSlBHICYmIGlzTHQyTTsKICAgIH0sCiAgICBnZXRVc2VySW5mbzogZnVuY3Rpb24gZ2V0VXNlckluZm8oKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdGhpcy4kYXhpb3MuZ2V0KCcvYXBpL3VzZXIvaW5mbycpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIHZhciByZXN1bHQgPSByZXMuZGF0YTsKCiAgICAgICAgaWYgKHJlc3VsdC5jb2RlID09PSAwKSB7CiAgICAgICAgICBfdGhpczIuZm9ybS5uaWNrbmFtZSA9IHJlc3VsdC5kYXRhLm5pY2tuYW1lOwoKICAgICAgICAgIGlmIChyZXN1bHQuZGF0YS5oZWFkX2ltZyA9PT0gJycgfHwgcmVzdWx0LmRhdGEuaGVhZF9pbWcgPT09IG51bGwpIHsKICAgICAgICAgICAgX3RoaXMyLmltYWdlVXJsID0gbnVsbDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzMi5pbWFnZVVybCA9IHJlc3VsdC5kYXRhLmhlYWRfaW1nOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgfSk7CiAgICB9LAogICAgc2lnbk91dDogZnVuY3Rpb24gc2lnbk91dCgpIHsKICAgICAgQ29va2llLnJlbW92ZSgndG9rZW4nKTsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRUb2tlbicsICcnKTsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdjaGFuZ0lzU2lnbkluJywgMCk7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICBuYW1lOiAnaG9tZScKICAgICAgfSk7CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRVc2VySW5mbygpOwogIH0KfTs="},{"version":3,"sources":["Personal.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div class=\"wrapper\">\n        <div class=\"content\">\n            <el-form :model=\"form\" ref=\"form\" label-width=\"80px\">\n                <el-form-item label=\"昵称\">\n                    <el-input v-model=\"form.nickname\" class=\"nickname\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"头像\">\n                    <el-upload\n                        class=\"avatar-uploader\"\n                        action=\"http://127.0.0.1:3000/api/user/upload\"\n                        :show-file-list=\"false\"\n                        :on-success=\"handleAvatarSuccess\"\n                        :before-upload=\"beforeAvatarUpload\"\n                        name=\"head_img\">\n                        <img :src=\"imageUrl!=null?imageUrl:imgDefault\" class=\"avatar\">\n                    </el-upload>\n                    <p class=\"tips\">tips:请上传2M以内JPG/PNG格式的图片，比例最好1:1</p>\n                </el-form-item>\n                <el-form-item>\n                    <el-button type=\"primary\" @click=\"save\">保存</el-button>\n                    <el-button @click=\"signOut\">退出登录</el-button>\n                </el-form-item>\n            </el-form>\n            \n        </div>\n    </div>\n</template>\n\n<script>\n    import imgDefault from '../assets/logo.png'\n    import Cookie from 'js-cookie'\n    export default {\n        data() {\n            return {\n                form:{\n                    nickname: this.nickname\n                },\n                imageUrl:null,\n                imgDefault: imgDefault\n            }\n        },\n        methods:{\n            save(){\n                this.$axios.post('/api/user/updateUser',{\n                    nickname:this.form.nickname,\n                    head_img:this.imageUrl\n                }).then(res => {\n                    console.log(res)\n                    if(res.data.code === 0){\n                        this.$message({\n                            message: '更新成功',\n                            type: 'success'\n                        });\n                        setTimeout(()=> {location.reload()},1500)\n                    }\n                }).catch(e => {\n                    console.log(e)\n                })\n            },\n            handleAvatarSuccess(res) {\n                this.imageUrl = res.data\n            },\n            beforeAvatarUpload(file) {\n                const isJPG = file.type === 'image/jpeg';\n                const isLt2M = file.size / 1024 / 1024 < 2;\n\n                if (!isJPG) {\n                    this.$message.error('上传头像图片只能是 JPG 格式!');\n                }\n                if (!isLt2M) {\n                    this.$message.error('上传头像图片大小不能超过 2MB!');\n                }\n                return isJPG && isLt2M;\n            },\n            getUserInfo(){\n                this.$axios.get('/api/user/info').then((res)=>{\n                    let result = res.data\n                    if(result.code === 0){\n                        this.form.nickname = result.data.nickname\n                        if(result.data.head_img === '' || result.data.head_img === null){\n                            this.imageUrl = null\n                        }else{\n                            this.imageUrl = result.data.head_img\n                        }\n                    }\n                }).catch(e=>{\n                    console.log(e)\n                })\n            },\n            signOut() {\n                Cookie.remove('token')\n                this.$store.commit('setToken','')\n                this.$store.commit('changIsSignIn',0)\n                this.$router.push({name:'home'})\n            }\n        },\n        created () {\n            this.getUserInfo()\n        }\n\n    }    \n\n</script>\n\n<style lang=\"scss\" scoped>\n.wrapper {\n    min-height: calc(100vh - 262px);\n    .content {\n        width: 40%;\n        margin: 0 auto;\n        padding: 50px 0;\n    }\n}\n.nickname {\n    width: 70%;\n}\n/deep/ .avatar-uploader {\n    .el-upload {\n        border: 1px dashed #d9d9d9;\n        border-radius: 6px;\n        cursor: pointer;\n        position: relative;\n        overflow: hidden;\n        &:hover {\n            border-color: #409EFF;\n        }\n    }\n    .avatar-uploader-icon {\n        font-size: 28px;\n        color: #8c939d;\n        width: 100px;\n        height: 100px;\n        line-height: 100px;\n        text-align: center;\n    }\n    .avatar {\n        width: 100px;\n        height: 100px;\n        display: block;\n    }\n}\n.tips {\n    font-size: 12px;\n    color: #999;\n}\n</style>"],"sourceRoot":"src/views"}]}